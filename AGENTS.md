# AGENTS.md

## 프로젝트 목적
- 부대 내 워게임 모델(시뮬레이션) 사용법/지침서를 근거로 질의응답하는 로컬 RAG 챗봇을 구현
- 목표는 인터넷 없이 로컬 PC에서 동작하는 운영 형태입니다(오프라인 배포/운영 전제)

## 작업 시작 규칙(필수)
1) 어떤 작업이든 시작하기 전에 아래 문서를 먼저 읽고 그 내용에 맞춰 진행
- `docs/architecture.md`
- `docs/decisions.md`
2) 위 문서와 충돌하는 지시가 들어오면, 충돌 지점을 명시하고 `docs/decisions.md`의 “Pending/Confirmed” 기준에 따라 처리

## 근거 중심(환각 최소화) 규칙
- 중요: 문서/청크 근거가 없으면 단정하지 않습니다.
- 구현물에서 답변 생성은 반드시 “검색된 근거 청크”에 제한되도록 설계합니다.
- 근거가 부족하면: “해당 내용은 제공된 문서 근거로 확인 불가”로 처리하고, 사용자에게 필요한 추가 문서/키워드를 제안합니다(추측 금지).

## 오프라인/자원 제약
- GPU는 가능한 한 **LLM 추론에만** 배정하는 방향을 우선
- 임베딩/리랭킹은 CPU 구동을 우선하며, 성능/지연이 문제면 옵션으로만 GPU를 고려
- 외부 네트워크가 없는 환경을 고려해, 모델/의존성은 사전 다운로드/캐시 고정이 가능한 구조로 유지

## 코드 작성 규칙
- 변경은 “작고 검증 가능한 단위”로 나눔
- 새 모듈/함수 추가 시:
  - 입력/출력 계약(타입, 예외, 반환 형태)을 명확히 함
  - 로깅/에러 메시지는 운영자가 원인 파악 가능하도록 작성
  - 가능한 범위에서 단위 테스트(또는 최소 재현 스크립트)를 추가
- 의존성 추가/교체는 최소화합니다. 추가가 필요하면 이유/대안/영향을 함께 남기기

## 문서화 규칙
- 구조/결정 변경이 생기면 `docs/architecture.md` 또는 `docs/decisions.md`를 같이 업데이트
- “확정(Confirmed)”으로 바뀐 결정은 `docs/decisions.md`에 반영

## 출력/답변(제품) 품질 기준
- 답변에는 근거 출처(문서/섹션/페이지/청크 식별자)를 포함할 수 있어야 함
- 동일 질문에 대한 재현성이 높도록, 검색/리랭킹/생성의 파라미터는 설정 파일로 고정 가능해야 함
